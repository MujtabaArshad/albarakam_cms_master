cmsdefine(["CMS/Core","CMS/EventHub","CMS/Application","jQuery"],function(n,t,i,r){var u={toolbarPlaceholderId:"cms-header-contexthelp"};return function(f){var p=new n(f,u),w=p.ctx,e=w.data,b=r("#"+e.toolbarId),h=r("#"+e.helpTopicsMenuItemId),l=h.find("ul.dropdown-menu"),k=r("#"+e.searchMenuItemId),o=k.find("input"),d=e.searchUrlPattern,s=r("#"+e.descriptionMenuItemId),c=r(".js-context-help"),g=function(n,t){r(t).bind("help",function(){return!1});var i={},f=v(window.top,i),u={};i.application?(u.description=i.application.description,u.helpTopics=i.application.helpTopics.concat(f)):u.helpTopics=f;a(u)},a=function(n){n||(n={});tt(n.helpTopics);nt(n.description)},v=function(n,t){var o=[],s=[],f=[],u,e;try{if(u=i.getData("contexthelp",n),u){if(u.suppressContextHelp)return o;!t.application&&u.contextHelp.application&&(t.application=u.contextHelp.application);s=u.contextHelp.helpTopics}if(n.frames.length)for(e=0;e<n.frames.length;e++)f=f.concat(v(n.frames[e],t));o=f.length?r(n.document).find("iframe").length?s.concat(f):f:s}catch(h){}return o},nt=function(n){if(!n){s.hide();return}s.empty();s.append(y(n));s.show()},tt=function(n){var t,i;if(!n||!n.length){h.hide();return}for(l.empty(),t=0;t<n.length;t++)i=n[t],l.append(r("<li><\/li>").append(y(i)));h.show()},y=function(n){return r('<a target="_blank" href="'+n.url+'"><\/a>').html(n.name)},it=function(){var n=encodeURIComponent(o.val().trim());n&&(window.open(d.replace("{0}",n)),o.val(""))},rt=function(n){n.key==112&&(c.click(),n.wasHandled=!0)},ut=function(){b.appendTo(r("#"+e.toolbarPlaceholderId)).removeClass("hide").on("shown.bs.collapse",function(){o.focus()}).on("hidden.bs.collapse",function(){o.val("")});a(null);c.click(function(){setTimeout(function(){window.top.layouts[0].resizeAll()},0)});o.keyup(function(n){n.which==13&&(n.preventDefault(),it())});t.subscribe("PageLoaded",g);t.subscribe("ShowContextHelp",function(){c.click()});t.subscribe("KeyPressed",rt)};ut()}})