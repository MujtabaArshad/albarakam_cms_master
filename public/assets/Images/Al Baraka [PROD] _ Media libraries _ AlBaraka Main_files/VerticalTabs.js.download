cmsdefine(["CMS/EventHub","CMS/Application","jQuery","CMS/UrlHelper","jQueryJScrollPane"],function(n,t,i,r){var ft={tabsScrollableElemSelector:".nav-tabs-container-vertical",tabsScrollShadowElemSelector:'<div class="scroll-shadow" style="display:none;"><\/div>'},l=t.getWindowLevel(window),h=null,et=null,g=null,a=null,s=!1,u=null,nt=null,tt=null,c=!1,v=null,ot=!1,y=!1,e=0,st=[],dt,ht=!1,p=!1,w=null,vt,b=null,f,k,d,yt=function(n){n.notBusy||e++;n.func.apply(n.sender,n.args);n.notBusy||e--},it=function(){var n;if(!ht){for(ht=!0;e<=0&&st.length>0;)n=st.shift(),n!=null&&yt(n);ht=!1}},gt=function(n,t,i){var r={func:n,args:t,sender:this,notBusy:i};e>0?st.push(r):(yt(r),it())},o=function(n,t){return function(){gt(n,arguments,t)}},ni=function(n){e++;n();e--;it()},rt=o(function(n){n.received||(n.received=!0,c=n.partial,c?ti():ni(function(){s=!0;h.hide("west")}))},!0),ti=o(function(){s||(e++,pt(),p=!1,s=!0,y=!0,u.addClass("nav-tabs-vertical-hiding"),window.Loader&&window.Loader.delay(),ii())},!0),ii=function(){var n,t;p||(ut(),n=parseInt(a.css("left"),10),t=parseInt(tt.css("width"),10),w=i.merge(g,i(".loader, .overlayer")),w.animate({marginLeft:"-="+(n-t)+"px"},{duration:500,complete:ri}))},ri=function(){p||(window.Loader&&window.Loader.delay(),u.addClass("nav-tabs-vertical-hidden"),u.removeClass("nav-tabs-vertical-hiding"),h.sizePane("west",tt.width()),g.css("marginLeft",0),setTimeout(function(){p||u.addClass("nav-tabs-vertical-hidden-hover")},500),e--,it())},ct=function(t){var i={sender:window};ot&&(l<100&&n.publish("Breadcrumbs_Back",i),i.back||(n.publish("Tabs_Back_"+(l-1),i),i.back&&rt({})));t&&t.preventDefault()},ui=function(n){var t,i;if(!n.received){if(n.received=!0,!s){rt({});return}t=a.prop("contentWindow").location.href;i=Tabs.getHistory(0).url;i.substr(0,1)=="/"&&(t="/"+t.replace(/^(?:\/\/|[^\/]+)*\//,""));n.back=t!=i;n.back&&Tabs.back(0);wt()}},pt=function(){p=!0;w&&(w.stop(!0,!0),w=null);u.removeClass("nav-tabs-vertical-hiding");u.removeClass("nav-tabs-vertical-hidden");u.removeClass("nav-tabs-vertical-hidden-hover");u.removeClass("nav-tabs-vertical-hidden-show");g.css("marginLeft",0)},wt=o(function(){s=!1;pt();nt.show();v.hide();h.sizePane("west","auto");h.show("west");ut()}),fi=o(function(){c&&(y?lt():at())},!0),lt=o(function(){c&&s&&(y=!1,u.addClass("nav-tabs-vertical-hidden-show"),v.show())}),at=o(function(){c&&s&&(y=!0,u.removeClass("nav-tabs-vertical-hidden-show"),v.hide())}),ei=function(){n.publish("Tabs_Hide_"+(l-1),{})},oi=o(function(){var n=a.prop("contentWindow"),i=t.getData("isVerticalTabs",n),r=t.getData("hideVerticalTabs",n);r?at():i?rt({}):wt()},!0),si=o(function(n){n.ctrlKey&&n.altKey&&n.key==37&&(c?!y&&ot?ct():fi():ct(),n.wasHandled=!0)}),hi=function(){vt=i(window);f=i(ft.tabsScrollableElemSelector);k=i(ft.tabsScrollShadowElemSelector);d=i(ft.tabsScrollShadowElemSelector).addClass("bottom");i(".jspContainer").length===0&&li();f.on({"shown.bs.collapse":kt,"hidden.bs.collapse":kt});vt.resize(_.debounce(function(){ut()},250))},bt=function(n,t,i){t?k.hide():k.show();i?d.hide():d.show()},ci=function(n,t){t?bt(n,b.getPercentScrolledY()===0,b.getPercentScrolledY()===1):(k.hide(),d.hide())},li=function(){f.css({position:"absolute",top:f.position().top+"px",left:0,right:0,bottom:0,outline:"none"});i(".nav-tabs-site-selector").length>0&&i("ul.TabControlTable").css("padding-top",0);f.jScrollPane({verticalGutter:-8,contentWidth:208});b=f.data("jsp");f.bind("jsp-arrow-change",bt);f.bind("jsp-initialised",ci);k.prependTo(f);d.prependTo(f)},ut=function(){b&&(b.reinitialise(),f.css("width","auto"))},kt=_.debounce(function(){ut()},20);return function(f){var e,o,s,c=f.id;h=window["layout_"+c];a=i("#"+c+"_c");a.load(oi);g=i(".ui-layout-pane, .ui-layout-pane-visible");u=i(".ui-layout-pane-west");nt=i(".nav-tabs-container-vertical-background");tt=i(".nav-tabs-container-vertical-hidden");tt.click(lt);nt.click(lt);v=i("#tabOverlayer");v.click(at);s=!t.getData("isDialog",window)&&parent!=window&&(t.getData("isAppList",parent)&&!t.getData("isApplication")||t.getData("isVerticalTabs",parent)||r.getParameter(window.location.href,"allownavigationtolisting"));s&&(et=i(".nav-tabs-back"),nt.addClass("nav-tabs-no-padding"),et.show(),et.find("button").click(ct),ot=!0);e="Tabs_Hide_"+l;n.subscribe(e,rt);o="Tabs_Back_"+l;n.subscribe(o,ui);h.sizePane("west","auto");ei();n.subscribe("KeyPressed",si);dt=setInterval(it,500);f.scrollable&&hi()}})